{"version":3,"sources":["src/component.js"],"names":[],"mappings":"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","file":"src/component.js","sourcesContent":["import angular from 'angular';\nimport Annotation from './annotation';\n\nexport class Component extends Annotation {\n    get controllerCls() {\n        var annotation = this;\n        var TargetCls = this.targetCls;\n\n        class ControllerCls extends TargetCls {\n            constructor($scope) {\n                var injected = Array.from(arguments).slice(1);\n\n                annotation.applyInjectionBindings(this, injected);\n                annotation.applyDecorators(this);\n\n                super(...injected);\n\n                if (this.onDestroy instanceof Function) {\n                    $scope.$on('$destroy', this.onDestroy.bind(this));\n                }\n\n                if (this.activate instanceof Function) {\n                    this.activate();\n                }\n            }\n        }\n\n        return ControllerCls;\n    }\n\n    getInjectionTokens() {\n        return [\n            '$scope'\n        ].concat(super.getInjectionTokens());\n    }\n\n    get dependencies() {\n        var targetCls = this.targetCls;\n        return [].concat(\n            targetCls.dependencies || [],\n            Annotation.getModuleNames(targetCls.components)\n        );\n    }\n\n    get template() {\n        return this.targetCls.template || null;\n    }\n\n    get bindings() {\n        return this.targetCls.bindings || null;\n    }\n\n    get module() {\n        if (!this._module) {\n            var name = this.name;\n            var template = this.template;\n            var bindings = this.bindings;\n\n            this._module = angular.module(\n                'components.' + name,\n                this.dependencies\n            );\n\n            var directiveConfig = {\n                restrict: 'E',\n                controllerAs: name,\n                bindToController: true,\n                scope: true,\n                controller: this.getInjectionTokens().concat([\n                    this.controllerCls\n                ])\n            };\n\n            if (template) {\n                if (template.url) {\n                    directiveConfig.templateUrl = template.url;\n                } else if (template.inline) {\n                    directiveConfig.template = template.inline;\n                }\n            }\n\n            if (bindings) {\n                let scope = directiveConfig.scope = {};\n                for (let binding of Object.keys(bindings)) {\n                    let attr = bindings[binding];\n                    scope[binding] = `=${attr}`;\n                }\n            }\n\n            this._module.directive(name, () => {\n                return directiveConfig;\n            });\n\n            this.configure(this._module);\n        }\n\n        return this._module;\n    }\n}\n\nexport default Component;\n"]}