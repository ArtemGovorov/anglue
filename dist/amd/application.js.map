{"version":3,"sources":["src/application.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;QAGa,WAAW;iBAAX,WAAW;kCAAX,WAAW;;;;;;;kBAAX,WAAW;;qBAAX,WAAW;;iBACJ,YAAG;AACf,oBAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;AAC/B,oBAAI,iBAAiB,GAAG,CAAC,UAAU,CAAC,CAAC;AACrC,oBAAI,SAAS,CAAC,MAAM,EAAE;AAClB,qCAAiB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;iBACvC;AACD,uBAAO,iBAAiB,CAAC,MAAM,CAC3B,SAAS,CAAC,YAAY,IAAI,EAAE,EAC5B,aAAW,cAAc,CAAC,SAAS,CAAC,UAAU,CAAC,EAC/C,aAAW,cAAc,CAAC,SAAS,CAAC,MAAM,CAAC,EAC3C,aAAW,cAAc,CAAC,SAAS,CAAC,OAAO,CAAC,CAC/C,CAAC;aACL;;;iBAES,YAAG;AACT,oBAAI,CAAC,IAAI,CAAC,OAAO,EAAE;AACf,wBAAM,eAAe,GAAG,aAAW,yBAAyB,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;AACpF,wBAAM,cAAc,GAAG,eAAe,CAAC,MAAM,CAAC,CAAC,YAAM,EAAE,CAAC,CAAC,CAAC;;AAE1D,wBAAI,CAAC,OAAO,GAAG,UAAQ,MAAM,CACzB,IAAI,CAAC,IAAI,EACT,IAAI,CAAC,YAAY,CACpB,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;;AAEtB,wBAAI,CAAC,SAAS,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;iBAChC;;AAED,uBAAO,IAAI,CAAC,OAAO,CAAC;aACvB;;;mBAEQ,mBAAC,aAAa,EAAE;;;;AAIrB,6BAAa,CAAC,OAAO,CAAC,uBAAuB,EAAE,CAC3C,oBAAoB,EACpB,UAAS,UAAU,EAAE;AACjB,2BAAO,IAAI,UAAU,CAAC,uBAAuB,CAAC,CAAC;iBAClD,CACJ,CAAC,CAAC;;AAEH,oBAAI,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;AACnC,oBAAI,MAAM,EAAE;AACR,iCAAa,CAAC,MAAM,CAAC,CACjB,gBAAgB,EAChB,oBAAoB,EACpB,SAAS,YAAY,CAAC,cAAc,EAAE,kBAAkB,EAAE;AACtD,4BAAI,MAAM,CAAC,YAAY,EAAE;AACrB,8CAAkB,CAAC,SAAS,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;AAClD,mCAAO,MAAM,CAAC,YAAY,CAAC;yBAC9B;;AAED,8BAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAC,IAAI,EAAK;AAClC,0CAAc,CAAC,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;yBAC5C,CAAC,CAAC;qBACN,CACJ,CAAC,CAAC;iBACN;aACJ;;;eA3DQ,WAAW;;;YAAX,WAAW,GAAX,WAAW;yBA6DT,WAAW","file":"src/application.js","sourcesContent":["import angular from 'angular';\nimport Annotation from './annotation';\n\nexport class Application extends Annotation {\n    get dependencies() {\n        var targetCls = this.targetCls;\n        var extraDependencies = ['luxyflux'];\n        if (targetCls.routes) {\n            extraDependencies.push('ui.router');\n        }\n        return extraDependencies.concat(\n            targetCls.dependencies || [],\n            Annotation.getModuleNames(targetCls.components),\n            Annotation.getModuleNames(targetCls.stores),\n            Annotation.getModuleNames(targetCls.actions)\n        );\n    }\n\n    get module() {\n        if (!this._module) {\n            const annotationNames = Annotation.getAnnotationServiceNames(this.targetCls.stores);\n            const controllerDeps = annotationNames.concat([() => {}]);\n\n            this._module = angular.module(\n                this.name,\n                this.dependencies\n            ).run(controllerDeps);\n\n            this.configure(this._module);\n        }\n\n        return this._module;\n    }\n\n    configure(angularModule) {\n        // The ApplicationDispatcher is the (singleton) dispatcher instance used\n        // in our entire application. Every ActionCreator in this app dispatches\n        // through this instance and all app stores are registered to it\n        angularModule.service('ApplicationDispatcher', [\n            'LuxyFluxDispatcher',\n            function(Dispatcher) {\n                return new Dispatcher('ApplicationDispatcher');\n            }\n        ]);\n\n        var routes = this.targetCls.routes;\n        if (routes) {\n            angularModule.config([\n                '$stateProvider',\n                '$urlRouterProvider',\n                function routerConfig($stateProvider, $urlRouterProvider) {\n                    if (routes.defaultRoute) {\n                        $urlRouterProvider.otherwise(routes.defaultRoute);\n                        delete routes.defaultRoute;\n                    }\n\n                    Object.keys(routes).forEach((name) => {\n                        $stateProvider.state(name, routes[name]);\n                    });\n                }\n            ]);\n        }\n    }\n}\nexport default Application;\n"]}